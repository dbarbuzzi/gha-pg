name: "on-push action"

on:
  push:
  workflow_dispatch:

jobs:
  Run-Action:
    runs-on: ubuntu-latest
    defaults:
      run:
        shell: bash

    outputs:
      blessed: steps.blessed.outputs.BLESSED
      doomed: steps.doomed.outputs.DOOMED

    steps:
      - name: blessed
        id: blessed
        run: echo "BLESSED=1" >> $GITHUB_OUTPUT

      - name: plain
        if: success() || failure() && steps.blessed.outputs.BLESSED == '1'
        run: echo "hi"
      - name: plain logic-nested
        if: (success() || failure()) && steps.blessed.outputs.BLESSED == '1'
        run: echo "hi"

      - name: fully wrapped
        if: ${{ success() || failure() && steps.blessed.outputs.BLESSED == '1' }}
        run: echo "hi"
      - name: fully wrapped logic-nested
        if: ${{ (success() || failure()) && steps.blessed.outputs.BLESSED == '1' }}
        run: echo "hi"

      - name: mixed
        if: success() || failure() && ${{ steps.blessed.outputs.BLESSED == '1' }}
        run: echo "hi"
      - name: mixed logic-nested
        if: (success() || failure()) && ${{ steps.blessed.outputs.BLESSED == '1'}}
        run: echo "hi"

      - name: doomed
        id: doomed
        run: |
          echo "DOOMED=1" >> $GITHUB_OUTPUT

      - name: plain
        if: success() || failure() && steps.doomed.outputs.DOOMED == '1'
        run: echo "hi"
      - name: plain logic-nested
        if: (success() || failure()) && steps.doomed.outputs.DOOMED == '1'
        run: echo "hi"

      - name: fully wrapped
        if: ${{ success() || failure() && steps.doomed.outputs.DOOMED == '1' }}
        run: echo "hi"
      - name: fully wrapped logic-nested
        if: ${{ (success() || failure()) && steps.doomed.outputs.DOOMED == '1' }}
        run: echo "hi"

      - name: mixed
        if: success() || failure() && ${{ steps.doomed.outputs.DOOMED == '1' }}
        run: echo "hi"
      - name: mixed logic-nested
        if: (success() || failure()) && ${{ steps.doomed.outputs.DOOMED == '1'}}
        run: echo "hi"

  Skipper:
    if: github.action == 'bobert'
    runs-on: ubuntu-latest
    defaults:
      run:
        shell: bash
    steps:
      - run: echo "hi"

  Follow-Up-A:
    runs-on: ubuntu-latest
    defaults:
      run:
        shell: bash
    needs: [Run-Action]
    if: needs.Run-Action.outputs.doomed == '1' && ! cancelled()
    steps:
      - run: echo "hi"

  Follow-Up-B:
    runs-on: ubuntu-latest
    defaults:
      run:
        shell: bash
    needs: Skipper
    if: always()
    steps:
      - run: echo "hi"
